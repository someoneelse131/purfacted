# ============================================
# PurFacted Environment Configuration
# ============================================
# Copy this file to .env and fill in your values
# All values are configurable - nothing is hardcoded

# ============================================
# APP CONFIGURATION
# ============================================
APP_PORT=3000
APP_HOST=0.0.0.0
PUBLIC_URL=https://purfacted.com
NODE_ENV=development

# ============================================
# DATABASE (PostgreSQL)
# ============================================
# Internal Docker network connection
DB_HOST=postgres
DB_PORT=5432
DB_NAME=purfacted
DB_USER=purfacted
DB_PASSWORD=change_this_secure_password

# Full connection string (auto-generated from above, or override)
DATABASE_URL=postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}

# Optional: Expose database port for debugging (default: false)
EXPOSE_DB_PORT=false
EXPOSE_DB_PORT_NUMBER=5433

# ============================================
# REDIS
# ============================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=change_this_redis_password

# Optional: Expose Redis port for debugging (default: false)
EXPOSE_REDIS_PORT=false
EXPOSE_REDIS_PORT_NUMBER=6380

# ============================================
# MAIL CONFIGURATION
# ============================================
MAIL_HOST=smtp.example.com
MAIL_PORT=587
MAIL_USER=noreply@purfacted.com
MAIL_PASSWORD=your_mail_password
MAIL_FROM=noreply@purfacted.com
MAIL_FROM_NAME=PurFacted
MAIL_ENCRYPTION=tls

# ============================================
# LLM API (Grammar Check)
# ============================================
LLM_PROVIDER=anthropic
LLM_API_KEY=your_anthropic_api_key
LLM_MODEL=claude-3-haiku-20240307

# ============================================
# AUTHENTICATION
# ============================================
# Session duration in days
SESSION_DURATION_DAYS=7
SESSION_REMEMBER_ME_DAYS=30

# Email verification
EMAIL_VERIFICATION_EXPIRY_HOURS=24

# Password reset
PASSWORD_RESET_EXPIRY_HOURS=1
PASSWORD_RESET_MAX_REQUESTS_PER_HOUR=3

# Password requirements
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_NUMBER=true
PASSWORD_REQUIRE_SPECIAL=true

# Login rate limiting
LOGIN_MAX_ATTEMPTS=5
LOGIN_LOCKOUT_MINUTES=15

# ============================================
# TRUST SCORE CONFIGURATION
# ============================================
# Points for actions (can be negative)
TRUST_FACT_APPROVED=10
TRUST_FACT_WRONG=-20
TRUST_FACT_OUTDATED=0
TRUST_VETO_SUCCESS=5
TRUST_VETO_FAIL=-5
TRUST_VERIFICATION_CORRECT=3
TRUST_VERIFICATION_WRONG=-10
TRUST_UPVOTED=1
TRUST_DOWNVOTED=-1

# Starting trust scores
TRUST_NEW_USER_START=10
TRUST_ORGANIZATION_START=50

# ============================================
# VOTE WEIGHT CONFIGURATION
# ============================================
# Base weights by user type
VOTE_WEIGHT_ANONYMOUS=0.1
VOTE_WEIGHT_VERIFIED=2
VOTE_WEIGHT_EXPERT=5
VOTE_WEIGHT_PHD=8
VOTE_WEIGHT_ORGANIZATION=100
VOTE_WEIGHT_MODERATOR=3

# Trust score modifiers (multiplied with base weight)
VOTE_MODIFIER_TRUST_100_PLUS=1.5
VOTE_MODIFIER_TRUST_50_99=1.2
VOTE_MODIFIER_TRUST_0_49=1.0
VOTE_MODIFIER_TRUST_NEG1_NEG25=0.5
VOTE_MODIFIER_TRUST_NEG26_NEG50=0.25
VOTE_MODIFIER_TRUST_BELOW_NEG50=0

# ============================================
# FACT CONFIGURATION
# ============================================
FACT_TITLE_MAX_LENGTH=200
FACT_BODY_MAX_LENGTH=5000
FACT_MAX_PER_DAY_NEW_USER=5
FACT_MIN_VOTES_FOR_STATUS=20

# Status thresholds (percentage)
FACT_PROVEN_THRESHOLD=75
FACT_DISPROVEN_THRESHOLD=25

# ============================================
# SOURCE CREDIBILITY
# ============================================
SOURCE_CREDIBILITY_PEER_REVIEWED=5
SOURCE_CREDIBILITY_OFFICIAL=4
SOURCE_CREDIBILITY_NEWS=3
SOURCE_CREDIBILITY_COMPANY=2
SOURCE_CREDIBILITY_BLOG=1

# ============================================
# COMMENTS & DISCUSSIONS
# ============================================
COMMENT_MAX_LENGTH=2000
DISCUSSION_MAX_LENGTH=2000

# ============================================
# DEBATES
# ============================================
DEBATE_MAX_MESSAGES_PER_DAY_STRANGER=10
DEBATE_HISTORY_RETENTION_DAYS=365

# ============================================
# MODERATION
# ============================================
# Moderator auto-election thresholds
MODERATOR_BOOTSTRAP_THRESHOLD=100
MODERATOR_EARLY_THRESHOLD=500
MODERATOR_TOP_PERCENT=10
MODERATOR_MIN_TRUSTED_USERS=100

# Inactive moderator
MODERATOR_INACTIVE_DAYS=30

# Expert verification
VERIFICATION_APPROVALS_REQUIRED=3

# ============================================
# BAN SYSTEM
# ============================================
BAN_FIRST_OFFENSE_DAYS=3
BAN_SECOND_OFFENSE_DAYS=30
# Third offense is permanent

# Negative veto flagging
VETO_FAIL_THRESHOLD_FOR_FLAG=5

# ============================================
# RATE LIMITING
# ============================================
RATE_LIMIT_ANONYMOUS_VOTES_PER_DAY=1
RATE_LIMIT_USER_VOTES_PER_DAY=10
RATE_LIMIT_API_REQUESTS_PER_MINUTE=60

# ============================================
# BOT PREVENTION
# ============================================
# Captcha (reCAPTCHA v3)
CAPTCHA_SITE_KEY=your_recaptcha_site_key
CAPTCHA_SECRET_KEY=your_recaptcha_secret_key

# Disposable email check API
DISPOSABLE_EMAIL_API_URL=https://disposable.debounce.io

# ============================================
# EXTERNAL SERVICES (Optional)
# ============================================
# If you want to use external services for email, etc.
# SENDGRID_API_KEY=
# AWS_SES_REGION=
# AWS_SES_ACCESS_KEY=
# AWS_SES_SECRET_KEY=

# ============================================
# TESTING
# ============================================
# Test database (separate from main)
TEST_DATABASE_URL=postgresql://purfacted:test_password@localhost:5433/purfacted_test

# ============================================
# FEATURE FLAGS
# ============================================
FEATURE_LLM_GRAMMAR_CHECK=true
FEATURE_EMAIL_NOTIFICATIONS=true
FEATURE_ANONYMOUS_VOTING=true
FEATURE_ORGANIZATION_ACCOUNTS=true
FEATURE_DEBATES=true
